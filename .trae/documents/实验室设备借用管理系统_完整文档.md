# 实验室设备借用管理系统 - 项目完整文档

本文档整合了项目的产品需求文档 (PRD)、技术架构文档以及最新的功能迭代更新。本项目旨在为高校实验室、社团器材室等场景提供数字化的设备借用管理解决方案。

## 1. 项目概述

实验室设备借用管理系统采用前后端分离架构，实现设备借用流程的数字化管理。解决传统纸质登记效率低、易出错的问题，让师生能够便捷查看设备状态、在线申请借用，管理员高效管理设备库存和借用记录。

## 2. 核心功能与业务逻辑

### 2.1 用户角色

| 角色       | 使用方式         | 核心权限                       |
| -------- | ------------ | -------------------------- |
| **普通用户** | 输入姓名使用       | 浏览设备、搜索筛选、申请借用、查看个人记录、申请归还 |
| **管理员**  | 输入姓名+选择管理员身份 | 设备管理（增删改）、借用审核、归还确认、查看所有记录 |

### 2.2 功能模块详解

#### 1. 用户身份模块

* 支持姓名输入登录，无需复杂注册。

* 身份选择：学生/管理员。

#### 2. 设备浏览与检索模块 (更新)

* **列表展示**：网格化展示设备图片、名称、状态。

* **状态筛选**：全部 / 可借用 / 已借出。

* **分类筛选 (新增)**：支持按类型筛选（光学仪器、电子设备、耗材、其他）。

* **关键词搜索 (新增)**：支持按设备名称、描述或ID进行模糊搜索。

#### 3. 借用申请模块 (更新)

* **在线申请**：填写借用时间、归还时间、用途。

* **备用联系方式 (新增)**：借用时可选填手机号/学号，便于紧急联系。

* **借用冲突检测 (新增)**：系统自动检查申请时间段是否已被占用，防止重复借用。

* **借用时长限制 (新增)**：不同设备可设置最大借用时长（如投影仪最多3天），超期无法提交申请。

#### 4. 归还管理模块 (更新)

* **归还确认机制 (新增)**：

  1. 用户在个人中心点击“申请归还”，状态变更为“归还审核中”。
  2. 管理员在后台收到请求，核实设备无误后点击“确认归还”，流程结束，设备恢复“可借用”状态。

#### 5. 设备管理模块

* 管理员可维护设备信息，包括名称、图片、描述、类型及最大借用时长。

### 2.3 核心业务流程

**普通用户流程**：

> 进入系统 → 输入姓名 → 浏览/搜索设备 → 填写申请（系统自动校验冲突与时长） → 提交申请 → 等待管理员审核 → 使用设备 → 个人中心申请归还 → 等待管理员确认归还

**管理员流程**：

> 登录 → 设备管理/审核借用/确认归还
>
> * **审核借用**：同意（设备变更为“已借出”）/ 拒绝
>
> * **确认归还**：确认（设备变更为“可借用”）

## 3. 用户界面设计

### 3.1 设计风格

* **主色调**：科技蓝 (#1890ff) + 清新白

* **视觉效果**：采用液态玻璃拟态 (Liquid Glassmorphism) 设计，包含动态流体背景、磨砂玻璃卡片、平滑过渡动画。

* **响应式**：适配桌面端、平板及移动端，支持触摸操作。

### 3.2 页面结构

| 页面       | 路由                 | 功能描述                       |
| -------- | ------------------ | -------------------------- |
| **首页**   | `/`                | 登录页，包含动态背景、身份选择            |
| **设备列表** | `/devices`         | 顶部包含搜索框、类型/状态筛选器，下方为设备卡片网格 |
| **借用申请** | `/borrow/:id`      | 表单页，包含时间选择（带校验）、用途、联系方式    |
| **个人中心** | `/profile`         | 时间轴展示借用记录，提供“归还”操作按钮       |
| **设备管理** | `/admin/devices`   | 管理员专用，设备增删改查               |
| **审核管理** | `/admin/approvals` | 管理员专用，包含“借用审核”和“归还审核”两个面板  |

## 4. 技术架构

### 4.1 技术栈

* **前端**：Vue 3 + Vite + TypeScript + Pinia + Element Plus

* **后端**：Spring Boot + MyBatis + MySQL (规划中，目前使用 Mock 数据)

* **通信**：RESTful API (JSON)

### 4.2 前端架构 (Vue 3)

* **Stores (Pinia)**:

  * `user`: 管理用户登录状态。

  * `device`: 管理设备数据、分类、状态。

  * `borrow`: 管理借用记录、冲突检测逻辑。

### 4.3 数据模型设计

#### User (用户)

```typescript
interface User {
  id: number
  name: string
  role: 'student' | 'admin'
  createTime: string
}
```

#### Device (设备) - (已更新)

```typescript
interface Device {
  id: number
  name: string
  image: string
  description: string
  status: 'available' | 'borrowed'
  type: 'optical' | 'electronic' | 'consumable' | 'other' // 新增分类
  maxDuration?: number // 新增最大借用时长(天)
  createTime: string
}
```

#### BorrowRecord (借用记录) - (已更新)

```typescript
interface BorrowRecord {
  id: number
  userName: string
  deviceId: number
  deviceName: string
  startTime: string
  endTime: string
  purpose: string
  contactInfo?: string // 新增备用联系方式
  status: 'pending' | 'approved' | 'rejected' | 'returned' | 'return_pending' // 新增 return_pending 状态
  createTime: string
}
```

## 5. 数据库设计 (规划)

### 用户表 (users)

```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL UNIQUE,
    role VARCHAR(20) NOT NULL DEFAULT 'student',
    create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 设备表 (devices) - (更新)

```sql
CREATE TABLE devices (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    image_url VARCHAR(255),
    description TEXT,
    status VARCHAR(20) NOT NULL DEFAULT 'available',
    type VARCHAR(20) NOT NULL DEFAULT 'other', -- 新增字段
    max_duration INT DEFAULT NULL, -- 新增字段
    create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_status (status),
    INDEX idx_type (type)
);
```

### 借用记录表 (borrow\_records) - (更新)

```sql
CREATE TABLE borrow_records (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL, -- 或直接存 userName，视需求而定
    device_id INT NOT NULL,
    start_time DATETIME NOT NULL,
    end_time DATETIME NOT NULL,
    purpose TEXT NOT NULL,
    contact_info VARCHAR(50), -- 新增字段
    status VARCHAR(20) NOT NULL DEFAULT 'pending',
    create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (device_id) REFERENCES devices(id)
);
```

## 6. 后续规划

1. **后端对接**：实现真实的 Spring Boot 后端接口。
2. **消息通知**：接入邮件或短信通知，提醒归还或审核结果。
3. **扫码功能**：支持二维码扫码快速借还。

